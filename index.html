<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gym Community</title>
<style>
body{font-family:Arial,sans-serif;background:#f5f5f5;color:#111;margin:0;padding:0;}
header{background:#1e1e1e;color:#fff;padding:15px;text-align:center;font-size:24px;}
.container{max-width:900px;margin:20px auto;padding:10px;}
.post-form{background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1);margin-bottom:20px;}
.post-form input, .post-form textarea{width:100%;padding:10px;margin-bottom:10px;border-radius:5px;border:1px solid #ccc;}
.post-form button{padding:10px 15px;background:#ff6b6b;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:0.3s;}
.post-form button:hover{background:#e05555;}
.posts{list-style:none;padding:0;}
.post{background:#fff;padding:15px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1);margin-bottom:15px;position:relative;opacity:0;transform:translateY(20px);transition:0.5s;}
.post.visible{opacity:1;transform:translateY(0);}
.post h4{margin-bottom:5px;color:#ff6b6b;}
.post p{margin-bottom:5px;}
.post small{color:#555;}
.delete-btn{position:absolute;top:10px;right:10px;background:#e05555;color:#fff;border:none;padding:5px 8px;border-radius:5px;cursor:pointer;display:none;}
.post.admin .delete-btn{display:block;}
.comment-section{margin-top:10px;padding-left:15px;border-left:2px solid #ff6b6b;}
.comment{background:#f1f1f1;padding:8px;border-radius:5px;margin-bottom:5px;position:relative;}
.comment h5{margin:0 0 3px 0;color:#1e1e1e;font-size:14px;}
.comment p{margin:0;font-size:13px;}
.comment .delete-btn{position:absolute;top:5px;right:5px;background:#e05555;color:#fff;border:none;padding:2px 5px;border-radius:5px;cursor:pointer;display:none;}
.comment.admin .delete-btn{display:block;}
</style>
</head>
<body>

<header>Gym Community</header>

<div class="container">

<!-- Form đăng bài -->
<div class="post-form">
<input type="text" id="username" placeholder="Tên của bạn (hoặc Admin)" required>
<textarea id="postContent" placeholder="Viết bài tập, thảo luận, mẹo gym..." rows="3" required></textarea>
<button id="postBtn">Đăng bài</button>
</div>

<!-- Danh sách bài viết -->
<ul class="posts" id="postsList"></ul>

</div>

<script>
// ===== localStorage demo =====
let posts = JSON.parse(localStorage.getItem('gymPosts')) || [];

// ===== render posts =====
function renderPosts(){
  const postsList = document.getElementById('postsList');
  postsList.innerHTML = '';
  posts.forEach((post,index)=>{
    const postEl = document.createElement('li');
    postEl.classList.add('post');
    postEl.classList.add(post.username.toLowerCase() === 'admin' ? 'admin' : '');
    setTimeout(()=>postEl.classList.add('visible'),50);
    postEl.innerHTML = `
      <h4>${post.username}</h4>
      <p>${post.content}</p>
      <small>${new Date(post.time).toLocaleString()}</small>
      ${post.username.toLowerCase() === 'admin' ? `<button class="delete-btn" onclick="deletePost(${index})">Xóa</button>` : ''}
      <div class="comment-section">
        <input type="text" placeholder="Bình luận..." onkeypress="handleComment(event, ${index})">
        <div class="comments">
          ${post.comments.map((c,i)=>`
            <div class="comment ${c.username.toLowerCase() === 'admin' ? 'admin' : ''}">
              <h5>${c.username}</h5>
              <p>${c.content}</p>
              ${c.username.toLowerCase()==='admin'? `<button class="delete-btn" onclick="deleteComment(${index},${i})">Xóa</button>`: ''}
            </div>
          `).join('')}
        </div>
      </div>
    `;
    postsList.appendChild(postEl);
  });
}

// ===== thêm bài viết =====
document.getElementById('postBtn').addEventListener('click',()=>{
  const username = document.getElementById('username').value.trim();
  const content = document.getElementById('postContent').value.trim();
  if(username && content){
    posts.unshift({username,content,time:Date.now(),comments:[]});
    localStorage.setItem('gymPosts',JSON.stringify(posts));
    document.getElementById('postContent').value='';
    renderPosts();
  }
});

// ===== xóa bài (admin) =====
function deletePost(index){
  if(confirm('Bạn có chắc muốn xóa bài này?')){
    posts.splice(index,1);
    localStorage.setItem('gymPosts',JSON.stringify(posts));
    renderPosts();
  }
}

// ===== thêm bình luận =====
function handleComment(e,postIndex){
  if(e.key==='Enter'){
    const input = e.target;
    const commentText = input.value.trim();
    const username = prompt('Nhập tên của bạn:','Người dùng');
    if(commentText && username){
      posts[postIndex].comments.push({username,content:commentText});
      localStorage.setItem('gymPosts',JSON.stringify(posts));
      input.value='';
      renderPosts();
    }
  }
}

// ===== xóa bình luận (admin) =====
function deleteComment(postIndex,commentIndex){
  if(confirm('Bạn có chắc muốn xóa bình luận này?')){
    posts[postIndex].comments.splice(commentIndex,1);
    localStorage.setItem('gymPosts',JSON.stringify(posts));
    renderPosts();
  }
}

// ===== lần đầu render =====
renderPosts();
</script>

</body>
</html>
