<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Shape Fun</title>

<style>
body{
  background: url("591662926_4215648008755617_995818959069004156_n.jpg") center / cover no-repeat;
  text-align:center;
  font-family:Arial;
}

.game{display:flex;justify-content:center;gap:40px;margin:40px}

.slot{width:100px;height:100px;display:flex;align-items:center;justify-content:center}

.shape{
  width:100px;height:100px;
  position:absolute;
  cursor:pointer;
  touch-action:none;
  transition:0.15s;
}

.circle{background:red;border-radius:50%}
.square{background:green}
.triangle{background:blue;clip-path:polygon(50% 0%,0% 100%,100% 100%)}

@keyframes shake{
  0%,100%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  75%{transform:translateX(6px)}
}
</style>
</head>

<body>
<h2>ƒê·∫∑t h√¨nh v√†o ƒë√∫ng ch·ªó</h2>

<div class="game">
  <div class="slot" data-shape="circle">
    <svg width="100" height="100">
      <circle cx="50" cy="50" r="44" fill="none" stroke="#999" stroke-width="4"/>
    </svg>
  </div>

  <div class="slot" data-shape="square">
    <svg width="100" height="100">
      <rect x="6" y="6" width="88" height="88" fill="none" stroke="#999" stroke-width="4"/>
    </svg>
  </div>

  <div class="slot" data-shape="triangle">
    <svg width="100" height="100">
      <polygon points="50,6 6,94 94,94"
        fill="none" stroke="#999" stroke-width="4" stroke-linejoin="round"/>
    </svg>
  </div>
</div>

<div class="shape circle" data-shape="circle" style="top:320px;left:150px"></div>
<div class="shape square" data-shape="square" style="top:320px;left:300px"></div>
<div class="shape triangle" data-shape="triangle" style="top:320px;left:450px"></div>

<!-- üîä √ÇM THANH -->
<audio id="soundWin" src="hello.mp3" preload="auto"></audio>

<script>
let active=null,ox=0,oy=0,startX=0,startY=0;
const SNAP_DISTANCE = 60;

/* ===== M·ªû KH√ìA √ÇM THANH CHO MOBILE ===== */
let soundUnlocked = false;

function unlockSound(){
  if(soundUnlocked) return;
  const s = document.getElementById("soundWin");
  s.muted = true;
  s.play().then(()=>{
    s.pause();
    s.currentTime = 0;
    s.muted = false;
    soundUnlocked = true;
  }).catch(()=>{});
}
document.addEventListener("pointerdown", unlockSound, { once:true });

/* ===== PH√ÅT √ÇM THANH KHI ƒê√öNG ===== */
function playWinSound(){
  const s = document.getElementById("soundWin");
  s.currentTime = 0;
  s.play().catch(()=>{});
}

document.querySelectorAll('.shape').forEach(s=>{
  s.addEventListener('pointerdown',e=>{
    active=s;
    ox=e.clientX-s.offsetLeft;
    oy=e.clientY-s.offsetTop;
    startX=s.style.left;
    startY=s.style.top;
    s.setPointerCapture(e.pointerId);
  });
});

document.addEventListener('pointermove',e=>{
  if(!active) return;
  active.style.left=e.clientX-ox+"px";
  active.style.top=e.clientY-oy+"px";
});

document.addEventListener('pointerup',()=>{
  if(!active) return;
  let ok=false;

  document.querySelectorAll('.slot').forEach(slot=>{
    const shapeRect=active.getBoundingClientRect();
    const slotRect=slot.getBoundingClientRect();

    const dx=(shapeRect.left+50)-(slotRect.left+50);
    const dy=(shapeRect.top+50)-(slotRect.top+50);
    const distance=Math.sqrt(dx*dx+dy*dy);

    const outline=slot.querySelector("circle,rect,polygon");

    if(distance < SNAP_DISTANCE){
      if(slot.dataset.shape===active.dataset.shape){
        active.style.left=slotRect.left+"px";
        active.style.top=slotRect.top+"px";
        outline.setAttribute("stroke","#4caf50");
        playWinSound(); // üîä C√ì TI·∫æNG TR√äN ƒêI·ªÜN THO·∫†I
        ok=true;
      }else{
        outline.setAttribute("stroke","#f44336");
      }
    }
  });

  if(!ok){
    active.style.animation="shake 0.3s";
    active.style.left=startX;
    active.style.top=startY;
    setTimeout(()=>active.style.animation="",300);
  }

  active=null;
});
</script>

</body>
</html>