<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Báº£n Ä‘á»“ HÃ  Ná»™i</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{height:100vh}

#map{height:100vh;width:100vw}

/* Thanh tÃ¬m kiáº¿m */
.search-box{
  position:absolute;
  top:15px;
  left:50%;
  transform:translateX(-50%);
  background:#fff;
  width:92%;
  max-width:520px;
  display:flex;
  border-radius:30px;
  box-shadow:0 4px 12px rgba(0,0,0,.35);
  z-index:1000;
}
.search-box input{
  flex:1;
  padding:14px 20px;
  border:none;
  outline:none;
  border-radius:30px;
  font-size:16px;
}
.search-box button{
  background:#1a73e8;
  color:#fff;
  border:none;
  padding:0 24px;
  border-radius:30px;
  cursor:pointer;
}

/* Logo */
.logo{
  position:absolute;
  top:15px;
  left:15px;
  background:#fff;
  padding:6px 12px;
  border-radius:10px;
  font-weight:bold;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
  z-index:1000;
}

/* NÃºt Ä‘á»‹nh vá»‹ */
.locate{
  position:absolute;
  bottom:30px;
  right:15px;
  background:#fff;
  padding:10px 14px;
  border-radius:50%;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
  z-index:1000;
  font-size:18px;
}
</style>
</head>

<body>

<div class="logo">ğŸ—º HÃ  Ná»™i Map</div>

<div class="search-box">
  <input id="search" placeholder="TÃ¬m Ä‘Æ°á»ng, Ä‘á»‹a Ä‘iá»ƒm táº¡i HÃ  Ná»™i">
  <button onclick="searchPlace()">ğŸ”</button>
</div>

<div class="locate" onclick="locateMe()">ğŸ“</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// Khá»Ÿi táº¡o báº£n Ä‘á»“ HÃ  Ná»™i
let map = L.map('map', {
  center:[21.0285,105.8542],
  zoom:13
});

// Báº£n Ä‘á»“ thÆ°á»ng
let normal = L.tileLayer(
  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
  {maxZoom:19}
).addTo(map);

// Báº£n Ä‘á»“ vá»‡ tinh
let satellite = L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  {maxZoom:19}
);

// Chuyá»ƒn lá»›p báº£n Ä‘á»“
L.control.layers(
  {"ğŸ—º Báº£n Ä‘á»“":normal,"ğŸ›° Vá»‡ tinh":satellite},
  null,
  {position:'bottomleft'}
).addTo(map);

let marker;

// Click Ä‘á»ƒ ghim vá»‹ trÃ­
map.on('click',function(e){
  if(marker) map.removeLayer(marker);
  marker=L.marker(e.latlng).addTo(map)
    .bindPopup(
      `ğŸ“ Tá»a Ä‘á»™:<br>
      ${e.latlng.lat.toFixed(6)}, 
      ${e.latlng.lng.toFixed(6)}`
    )
    .openPopup();
});

// TÃ¬m kiáº¿m Ä‘á»‹a Ä‘iá»ƒm HÃ  Ná»™i
function searchPlace(){
  let q=document.getElementById("search").value;
  if(!q) return;

  fetch(
    `https://nominatim.openstreetmap.org/search?format=json&limit=1&q=${q}, HÃ  Ná»™i`
  )
  .then(res=>res.json())
  .then(data=>{
    if(data.length>0){
      let lat=data[0].lat;
      let lon=data[0].lon;
      map.setView([lat,lon],16);
      if(marker) map.removeLayer(marker);
      marker=L.marker([lat,lon]).addTo(map)
        .bindPopup(data[0].display_name)
        .openPopup();
    }else{
      alert("KhÃ´ng tÃ¬m tháº¥y Ä‘á»‹a Ä‘iá»ƒm táº¡i HÃ  Ná»™i");
    }
  });
}

// Äá»‹nh vá»‹ vá»‹ trÃ­ hiá»‡n táº¡i
function locateMe(){
  map.locate({setView:true,maxZoom:16});
}

map.on('locationfound',function(e){
  if(marker) map.removeLayer(marker);
  marker=L.marker(e.latlng).addTo(map)
    .bindPopup("ğŸ“ Vá»‹ trÃ­ cá»§a báº¡n")
    .openPopup();
});

map.on('locationerror',function(){
  alert("KhÃ´ng thá»ƒ láº¥y vá»‹ trÃ­");
});
</script>

</body>
</html>
